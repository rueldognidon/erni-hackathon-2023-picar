<html>
    <head>
        <style>
            body{
                color: white;
            }

            .container {
                display: flex; 
                justify-content: center;
                margin-top: 10;
            }

            .controlButton {
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: lightgreen;
                border: transparent;
                width: 60;
                height: 50;
                font-size: large;
                font-weight: bold;
                color:#222;
            }

            .controlButton:active {
                background-color: lightcoral;
            }

            .icon {
                font-size: 35
            }


        </style>
        <script src="https://kit.fontawesome.com/53aa2ad808.js" crossorigin="anonymous"></script>
        <script>

            var wsUri="wss://sx5ivtfpjl.execute-api.ap-southeast-1.amazonaws.com/production";
            var websocket = new WebSocket(wsUri);

            websocket.onopen = function(evt) { onOpen(evt) };
            websocket.onmessage = function(evt) { onMessage(evt) };
            websocket.onerror = function(evt) { onError(evt) };

            function test(){
                document.getElementById("demo").innerHTML = "Hello";
            }

            function pathFinder(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"path_finder","speed":10}'
                }));
            }

            function auto(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"auto","s1":1,"s2":1.2,"s3":2.6,"s4":2.6,"s5":5.2,"s6":2.5,"s7":2.5,"s8":1.8,"s9":2.2,"s10":2.4,"s11":5.2,"s12":2.3,"s13":5.2}'
                }));
            }

            function forward(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_speed","speed":10}'
                }));
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_direction","angle":0}'
                }));
            }

            function fright(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_speed","speed":10}'
                }));
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_direction","angle":20}'
                }));

            }
            function fleft(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_speed","speed":10}'
                }));
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_direction","angle":-20}'
                }));
            }

            function backward(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_speed","speed":-10}'
                }));
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_direction","angle":0}'
                }));
            }

            function bright(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_speed","speed":-10}'
                }));
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_direction","angle":20}'
                }));
            }
            function bleft(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_speed","speed":-10}'
                }));
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_direction","angle":-20}'
                }));
            }
            
            function stop(){
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_speed","speed":0}'
                }));
                websocket.send(JSON.stringify({
                    action:"sendCommandToRaspberryPI",
                    command:'{"operation":"set_direction","angle":0}'
                }));
            }
            function onOpen() {
                console.log("connected to url");
                websocket.send("Hello");
                //  writeToScreen("Connected to " + wsUri);
            }

            function onMessage(evt) {
                document.getElementById("demo").innerHTML = evt.data;
            }

            function onError(evt) {
                document.getElementById("demo").innerHTML = evt.data;
            } 

            function onClose(evt)
            {
                console.log("Disconnected");
            }
        </script>
    </head>
    <body style="background-color: #222;">
        <div>

            <div class="container">
                <iframe src="http://10.163.91.34:9000/mjpg" width="640" height="480" hidden="true"></iframe>
                <iframe src="https://viewer.millicast.com?streamId=2Mb6tU/ephpicar&play=false&volume=false&fullscreen=false&pip=false&cast=false&liveBadge=false&userCount=false&disableSettings=true" allowfullscreen width="640" height="480"></iframe>
            </div>

            <div class="container">
                <div style="width: 420;">
                    <div class="container">
                        <input type="radio" id="Local"  name="video"><label for="Local">Local</label>
                        <input type="radio" id="Stream" name="video" checked="true"><label for="Stream">Stream</label>
                    </div>
                    <div class="container"><span style="font-weight: bold; font-size: small;">Sensor Status</span></div>
                    <div class="container"><span id="demo" style="color: white; align-content: center;"></span></div>
                </div>
                <table>
                    <tr>
                        <td colspan="3">
                            <table style="width: 100%;">
                                <tr>
                                    <td>Press</td>
                                    <td style="text-align: right;">Activate</td>
                                </tr>
                                <tr>
                                    <td>Unpress</td>
                                    <td style="text-align: right;">Deactivate</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td><div class="controlButton" onmousedown="fleft()" onmouseup="stop()"><span class="icon fa-solid fa-turn-up" style="rotate: -90deg;"></span></div></td>
                        <td><div class="controlButton" onmousedown="forward()" onmouseup="stop()"><span class="icon fa-solid fa-up-long"></span></div></td>
                        <td><div class="controlButton" onmousedown="fright()" onmouseup="stop()"><span class="icon fa-solid fa-turn-down" style="rotate: -90deg;"></span></div></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><div class="controlButton" onmousedown="stop()"><span class="icon fa-solid fa-stop"></span></div></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><div class="controlButton" onmousedown="bleft()" onmouseup="stop()"><span class="icon fa-solid fa-turn-down" style="rotate: 90deg;"></span></div></td>
                        <td><div class="controlButton" onmousedown="backward()" onmouseup="stop()"><span class="icon fa-solid fa-down-long"></span></div></td>
                        <td><div class="controlButton" onmousedown="bright()" onmouseup="stop()"><span class="icon fa-solid fa-turn-up" style="rotate: 90deg;"></span></div></td>
                    </tr>
                    <tr>
                        <td colspan="3">Automations:</td>
                    </tr>
                    <tr>
                        <td><div class="controlButton" onmousedown="pathFinder()"><span class="icon fa-solid fa-robot"></span></div></td>
                        <td><div class="controlButton" onmousedown="auto()"><span class="icon fa-solid fa-route"></span></div></td>
                        <td></td>
                    </tr>
                </table>
            </div>
       </div>
    </body>
</html>